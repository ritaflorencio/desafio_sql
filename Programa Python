from numpy import float
import pandas as pd

# Ler CSV
dados = pd.read_csv('/content/DB_Teste.csv', sep = ';', encoding='latin1')

dados['Valor'] = dados['Valor'].str.replace('R\$', '', regex=True)
dados['Valor'] = dados['Valor'].str.replace('\.', '', regex=True)
dados['Valor'] = dados['Valor'].str.replace(',', '.', regex=True)

dados['Valor'] = dados['Valor'].str.strip().astype(float)

dados['Valor'] = dados['Valor'].round(2)


#Construa uma tabela auxiliar que sumarize o valor vendido por cada vendedor, ordenando do maior para o menor
vendedor_sum = dados.groupby('Vendedor')['Valor'].sum().reset_index()
vendedor_sum['Valor'] = vendedor_sum['Valor'].astype(float).round(2)
vendedor_sum = vendedor_sum.sort_values(by='Valor', ascending=False)
print(vendedor_sum)
print (dados)
print(dados.columns)


#Imprima e identifica qual foi o cliente responsável pela venda com maior valor e com menor valor
cliente_maior_valor = dados[dados['Valor'] == dados['Valor'].max()]['ï»¿Cliente'].values[0]
cliente_menor_valor = dados[dados['Valor'] == dados['Valor'].min()]['ï»¿Cliente'].values[0]
print(f"Cliente com a maior venda: {cliente_maior_valor}")
print(f"Cliente com a menor venda: {cliente_menor_valor}")

#Imprima valor médio por Tipo de venda (Serviços, Licenciamento, Produtos)
media_tipo = dados.groupby('Tipo')['Valor'].mean().round(2)
print("Valor médio por tipo de venda:")
print(media_tipo)

#Imprima o número de vendas realizada por cliente
vendas_cliente = dados['ï»¿Cliente'].value_counts().round(2)
print("Número de vendas realizadas por cliente:")
print(vendas_cliente)
